Config saved to file ./saved_models/00/config.json

Running with the following configs:
	data_dir : Food-Kitchen
	model : C2DSR
	hidden_units : 256
	num_blocks : 2
	num_heads : 1
	GNN : 1
	dropout : 0.2
	optim : adam
	lr : 0.001
	lr_decay : 1
	weight_decay : 0.0005
	decay_epoch : 5
	max_grad_norm : 5.0
	leakey : 0.1
	maxlen : 15
	cpu : False
	cuda : True
	lambda : 0.7
	num_iter : 10
	batch_size : 256
	log_step : 200
	log : logs.txt
	save_epoch : 100
	save_dir : ./saved_models
	id : 00
	seed : 2040
	load : False
	model_file : None
	info : 
	undebug : False
	n_clients : 10
	local_epoch : 3
	eval_interval : 1
	frac : 1.0
	model_save_dir : ./saved_models/00


Loading data from Food-Kitchen with batch size 256...
Data loading done!
/root/ZhangHongYu/C2DSR-main/C2DSR_src/utils/GraphMaker.py:12: RuntimeWarning: divide by zero encountered in power
  r_inv = np.power(rowsum, -1).flatten()
real graph loaded!
graph loaded!
Start training:
client: 0, 2022-12-05 12:06:44.627391: step 14/1400 (round 1/10), loss = 10.825695 (27.711 sec/epoch), lr: 0.001000
mi: 2.6585076979228432
client: 1, 2022-12-05 12:07:12.505128: step 28/1400 (round 1/10), loss = 10.811902 (27.877 sec/epoch), lr: 0.001000
mi: 2.667548435926437
client: 2, 2022-12-05 12:07:31.155726: step 42/1400 (round 1/10), loss = 10.827315 (18.650 sec/epoch), lr: 0.001000
mi: 2.637241185562952
client: 3, 2022-12-05 12:07:52.743622: step 56/1400 (round 1/10), loss = 10.850659 (21.588 sec/epoch), lr: 0.001000
mi: 2.6443160176277165
client: 4, 2022-12-05 12:08:18.927958: step 70/1400 (round 1/10), loss = 10.844896 (26.184 sec/epoch), lr: 0.001000
mi: 2.6450729293482653
client: 5, 2022-12-05 12:08:43.239537: step 84/1400 (round 1/10), loss = 10.769265 (24.311 sec/epoch), lr: 0.001000
mi: 2.731191130195346
client: 6, 2022-12-05 12:09:09.299983: step 98/1400 (round 1/10), loss = 10.843012 (26.060 sec/epoch), lr: 0.001000
mi: 2.6203350637640277
client: 7, 2022-12-05 12:09:29.911156: step 112/1400 (round 1/10), loss = 10.819728 (20.611 sec/epoch), lr: 0.001000
mi: 2.6479975027697433
client: 8, 2022-12-05 12:09:54.987630: step 126/1400 (round 1/10), loss = 10.779738 (25.076 sec/epoch), lr: 0.001000
mi: 2.734698634488243
client: 9, 2022-12-05 12:10:21.814004: step 140/1400 (round 1/10), loss = 10.838998 (26.826 sec/epoch), lr: 0.001000
mi: 2.6706902836050306
Evaluating on dev set...
client: 0,  val round:1, time: 245.673077(s), X (MRR: 0.0231, NDCG@10: 0.0241, HR@10: 0.0475), Y (MRR: 0.0149, NDCG@10: 0.0143, HR@10: 0.0324)
client: 1,  val round:1, time: 246.759174(s), X (MRR: 0.0158, NDCG@10: 0.0161, HR@10: 0.0373), Y (MRR: 0.0103, NDCG@10: 0.0047, HR@10: 0.0097)
client: 2,  val round:1, time: 257.426885(s), X (MRR: 0.0149, NDCG@10: 0.0143, HR@10: 0.0309), Y (MRR: 0.0147, NDCG@10: 0.0130, HR@10: 0.0255)
client: 3,  val round:1, time: 295.941928(s), X (MRR: 0.0073, NDCG@10: 0.0045, HR@10: 0.0122), Y (MRR: 0.0064, NDCG@10: 0.0027, HR@10: 0.0067)
client: 4,  val round:1, time: 323.511084(s), X (MRR: 0.0097, NDCG@10: 0.0090, HR@10: 0.0263), Y (MRR: 0.0102, NDCG@10: 0.0073, HR@10: 0.0139)
client: 5,  val round:1, time: 324.359243(s), X (MRR: 0.0141, NDCG@10: 0.0145, HR@10: 0.0342), Y (MRR: 0.0142, NDCG@10: 0.0122, HR@10: 0.0243)
client: 6,  val round:1, time: 325.372576(s), X (MRR: 0.0074, NDCG@10: 0.0026, HR@10: 0.0081), Y (MRR: 0.0085, NDCG@10: 0.0055, HR@10: 0.0118)
client: 7,  val round:1, time: 326.366862(s), X (MRR: 0.0051, NDCG@10: 0.0000, HR@10: 0.0000), Y (MRR: 0.0150, NDCG@10: 0.0128, HR@10: 0.0226)
client: 8,  val round:1, time: 327.377350(s), X (MRR: 0.0187, NDCG@10: 0.0182, HR@10: 0.0323), Y (MRR: 0.0097, NDCG@10: 0.0076, HR@10: 0.0160)
client: 9,  val round:1, time: 328.382849(s), X (MRR: 0.0105, NDCG@10: 0.0072, HR@10: 0.0157), Y (MRR: 0.0104, NDCG@10: 0.0080, HR@10: 0.0152)
average round:1, time: 328.778275(s), X (MRR: 0.0127, NDCG@10: 0.0111, HR@10: 0.0245), Y (MRR: 0.0114, NDCG@10: 0.0088, HR@10: 0.0178)
client: 0, 2022-12-05 12:12:09.888490: step 154/1400 (round 2/10), loss = 10.848407 (24.270 sec/epoch), lr: 0.001000
mi: 2.616581115552358
client: 1, 2022-12-05 12:12:40.229288: step 168/1400 (round 2/10), loss = 10.828635 (30.340 sec/epoch), lr: 0.001000
mi: 2.622988846472332
client: 2, 2022-12-05 12:13:04.649201: step 182/1400 (round 2/10), loss = 10.863701 (24.420 sec/epoch), lr: 0.001000
mi: 2.656601801940373
client: 3, 2022-12-05 12:13:31.552706: step 196/1400 (round 2/10), loss = 10.867759 (26.903 sec/epoch), lr: 0.001000
mi: 2.6006183981895457
client: 4, 2022-12-05 12:13:53.712669: step 210/1400 (round 2/10), loss = 10.824624 (22.160 sec/epoch), lr: 0.001000
mi: 2.6354908934661316
client: 5, 2022-12-05 12:14:17.710233: step 224/1400 (round 2/10), loss = 10.787633 (23.997 sec/epoch), lr: 0.001000
mi: 2.6219922602176666
client: 6, 2022-12-05 12:14:46.571812: step 238/1400 (round 2/10), loss = 10.833926 (28.861 sec/epoch), lr: 0.001000
mi: 2.647951935870307
client: 7, 2022-12-05 12:15:12.276766: step 252/1400 (round 2/10), loss = 10.827101 (25.705 sec/epoch), lr: 0.001000
mi: 2.6217673199517395
client: 8, 2022-12-05 12:15:42.584315: step 266/1400 (round 2/10), loss = 10.785094 (30.307 sec/epoch), lr: 0.001000
mi: 2.6115033413682665
client: 9, 2022-12-05 12:16:09.268211: step 280/1400 (round 2/10), loss = 10.869494 (26.683 sec/epoch), lr: 0.001000
mi: 2.6725310146808616
Evaluating on dev set...
client: 0,  val round:2, time: 592.948750(s), X (MRR: 0.0740, NDCG@10: 0.0807, HR@10: 0.1424), Y (MRR: 0.0461, NDCG@10: 0.0536, HR@10: 0.1126)
client: 1,  val round:2, time: 594.132502(s), X (MRR: 0.0612, NDCG@10: 0.0661, HR@10: 0.1273), Y (MRR: 0.0575, NDCG@10: 0.0622, HR@10: 0.1100)
client: 2,  val round:2, time: 595.177280(s), X (MRR: 0.0561, NDCG@10: 0.0579, HR@10: 0.0997), Y (MRR: 0.0270, NDCG@10: 0.0280, HR@10: 0.0565)
client: 3,  val round:2, time: 596.226272(s), X (MRR: 0.0319, NDCG@10: 0.0314, HR@10: 0.0653), Y (MRR: 0.0256, NDCG@10: 0.0241, HR@10: 0.0471)
client: 4,  val round:2, time: 606.692947(s), X (MRR: 0.0288, NDCG@10: 0.0339, HR@10: 0.0827), Y (MRR: 0.0167, NDCG@10: 0.0153, HR@10: 0.0366)
client: 5,  val round:2, time: 615.946095(s), X (MRR: 0.0355, NDCG@10: 0.0317, HR@10: 0.0570), Y (MRR: 0.0192, NDCG@10: 0.0156, HR@10: 0.0312)
client: 6,  val round:2, time: 616.993408(s), X (MRR: 0.0263, NDCG@10: 0.0309, HR@10: 0.0772), Y (MRR: 0.0137, NDCG@10: 0.0097, HR@10: 0.0185)
client: 7,  val round:2, time: 617.863786(s), X (MRR: 0.0195, NDCG@10: 0.0199, HR@10: 0.0491), Y (MRR: 0.0187, NDCG@10: 0.0187, HR@10: 0.0435)
client: 8,  val round:2, time: 619.051748(s), X (MRR: 0.0247, NDCG@10: 0.0237, HR@10: 0.0502), Y (MRR: 0.0162, NDCG@10: 0.0113, HR@10: 0.0232)
client: 9,  val round:2, time: 619.962000(s), X (MRR: 0.0408, NDCG@10: 0.0391, HR@10: 0.0630), Y (MRR: 0.0240, NDCG@10: 0.0217, HR@10: 0.0372)
average round:2, time: 620.469110(s), X (MRR: 0.0399, NDCG@10: 0.0415, HR@10: 0.0814), Y (MRR: 0.0265, NDCG@10: 0.0260, HR@10: 0.0516)
client: 0, 2022-12-05 12:17:09.665105: step 294/1400 (round 3/10), loss = 9.365754 (32.356 sec/epoch), lr: 0.001000
mi: 2.378624804530825
client: 1, 2022-12-05 12:17:45.100949: step 308/1400 (round 3/10), loss = 9.339084 (35.436 sec/epoch), lr: 0.001000
mi: 2.3708650793348043
client: 2, 2022-12-05 12:18:15.122469: step 322/1400 (round 3/10), loss = 9.354954 (30.021 sec/epoch), lr: 0.001000
mi: 2.371963364737374
client: 3, 2022-12-05 12:18:49.779773: step 336/1400 (round 3/10), loss = 9.383832 (34.657 sec/epoch), lr: 0.001000
mi: 2.3707317786557334
client: 4, 2022-12-05 12:19:21.575507: step 350/1400 (round 3/10), loss = 9.317788 (31.795 sec/epoch), lr: 0.001000
mi: 2.3673505246639257
client: 5, 2022-12-05 12:19:54.087532: step 364/1400 (round 3/10), loss = 9.293287 (32.512 sec/epoch), lr: 0.001000
mi: 2.3768140694924766
client: 6, 2022-12-05 12:20:26.029084: step 378/1400 (round 3/10), loss = 9.320710 (31.941 sec/epoch), lr: 0.001000
mi: 2.374640196561814
client: 7, 2022-12-05 12:20:55.107624: step 392/1400 (round 3/10), loss = 9.297748 (29.078 sec/epoch), lr: 0.001000
mi: 2.374809827123369
client: 8, 2022-12-05 12:21:32.998494: step 406/1400 (round 3/10), loss = 9.295455 (37.891 sec/epoch), lr: 0.001000
mi: 2.370135076556887
client: 9, 2022-12-05 12:22:08.120387: step 420/1400 (round 3/10), loss = 9.372058 (35.121 sec/epoch), lr: 0.001000
mi: 2.3722864380904602
Evaluating on dev set...
client: 0,  val round:3, time: 951.785273(s), X (MRR: 0.0898, NDCG@10: 0.0992, HR@10: 0.1646), Y (MRR: 0.0505, NDCG@10: 0.0547, HR@10: 0.1050)
client: 1,  val round:3, time: 952.798720(s), X (MRR: 0.0798, NDCG@10: 0.0893, HR@10: 0.1584), Y (MRR: 0.0620, NDCG@10: 0.0675, HR@10: 0.1158)
client: 2,  val round:3, time: 953.680647(s), X (MRR: 0.0617, NDCG@10: 0.0672, HR@10: 0.1168), Y (MRR: 0.0257, NDCG@10: 0.0273, HR@10: 0.0565)
client: 3,  val round:3, time: 954.656348(s), X (MRR: 0.0550, NDCG@10: 0.0534, HR@10: 0.0776), Y (MRR: 0.0242, NDCG@10: 0.0231, HR@10: 0.0471)
client: 4,  val round:3, time: 955.729469(s), X (MRR: 0.0349, NDCG@10: 0.0388, HR@10: 0.0827), Y (MRR: 0.0177, NDCG@10: 0.0148, HR@10: 0.0314)
client: 5,  val round:3, time: 965.656650(s), X (MRR: 0.0433, NDCG@10: 0.0424, HR@10: 0.0722), Y (MRR: 0.0186, NDCG@10: 0.0151, HR@10: 0.0312)
client: 6,  val round:3, time: 975.649836(s), X (MRR: 0.0345, NDCG@10: 0.0365, HR@10: 0.0732), Y (MRR: 0.0122, NDCG@10: 0.0083, HR@10: 0.0185)
client: 7,  val round:3, time: 976.520560(s), X (MRR: 0.0281, NDCG@10: 0.0277, HR@10: 0.0528), Y (MRR: 0.0183, NDCG@10: 0.0183, HR@10: 0.0435)
client: 8,  val round:3, time: 977.518827(s), X (MRR: 0.0417, NDCG@10: 0.0408, HR@10: 0.0645), Y (MRR: 0.0185, NDCG@10: 0.0148, HR@10: 0.0285)
client: 9,  val round:3, time: 978.384856(s), X (MRR: 0.0420, NDCG@10: 0.0424, HR@10: 0.0709), Y (MRR: 0.0218, NDCG@10: 0.0205, HR@10: 0.0389)
average round:3, time: 978.777915(s), X (MRR: 0.0511, NDCG@10: 0.0538, HR@10: 0.0934), Y (MRR: 0.0270, NDCG@10: 0.0264, HR@10: 0.0516)
client: 0, 2022-12-05 12:23:00.392311: step 434/1400 (round 4/10), loss = 7.835722 (24.774 sec/epoch), lr: 0.001000
mi: 2.081761153680938
client: 1, 2022-12-05 12:23:29.073080: step 448/1400 (round 4/10), loss = 7.828327 (28.680 sec/epoch), lr: 0.001000
mi: 2.0770021843058726
client: 2, 2022-12-05 12:23:58.526697: step 462/1400 (round 4/10), loss = 7.815368 (29.453 sec/epoch), lr: 0.001000
mi: 2.05365401336125
client: 3, 2022-12-05 12:24:28.486159: step 476/1400 (round 4/10), loss = 7.861732 (29.959 sec/epoch), lr: 0.001000
mi: 2.079865782175746
client: 4, 2022-12-05 12:24:56.320702: step 490/1400 (round 4/10), loss = 7.836525 (27.834 sec/epoch), lr: 0.001000
mi: 2.072661665081978
client: 5, 2022-12-05 12:25:21.926187: step 504/1400 (round 4/10), loss = 7.774828 (25.605 sec/epoch), lr: 0.001000
mi: 2.069588378497532
client: 6, 2022-12-05 12:25:51.223335: step 518/1400 (round 4/10), loss = 7.811179 (29.297 sec/epoch), lr: 0.001000
mi: 2.0891925969294136
client: 7, 2022-12-05 12:26:16.250043: step 532/1400 (round 4/10), loss = 7.730422 (25.026 sec/epoch), lr: 0.001000
mi: 2.054766898921558
client: 8, 2022-12-05 12:26:47.634266: step 546/1400 (round 4/10), loss = 7.785574 (31.384 sec/epoch), lr: 0.001000
mi: 2.075363003356116
client: 9, 2022-12-05 12:27:20.426259: step 560/1400 (round 4/10), loss = 7.839743 (32.791 sec/epoch), lr: 0.001000
mi: 2.060994384118489
Evaluating on dev set...
client: 0,  val round:4, time: 1264.283152(s), X (MRR: 0.1209, NDCG@10: 0.1297, HR@10: 0.1899), Y (MRR: 0.0620, NDCG@10: 0.0686, HR@10: 0.1260)
client: 1,  val round:4, time: 1265.309698(s), X (MRR: 0.1139, NDCG@10: 0.1256, HR@10: 0.1925), Y (MRR: 0.0674, NDCG@10: 0.0736, HR@10: 0.1236)
client: 2,  val round:4, time: 1266.484997(s), X (MRR: 0.0747, NDCG@10: 0.0810, HR@10: 0.1271), Y (MRR: 0.0255, NDCG@10: 0.0277, HR@10: 0.0601)
client: 3,  val round:4, time: 1267.420294(s), X (MRR: 0.0584, NDCG@10: 0.0613, HR@10: 0.0980), Y (MRR: 0.0261, NDCG@10: 0.0260, HR@10: 0.0538)
client: 4,  val round:4, time: 1268.595839(s), X (MRR: 0.0458, NDCG@10: 0.0529, HR@10: 0.1015), Y (MRR: 0.0198, NDCG@10: 0.0176, HR@10: 0.0366)
client: 5,  val round:4, time: 1269.730088(s), X (MRR: 0.0569, NDCG@10: 0.0554, HR@10: 0.0837), Y (MRR: 0.0262, NDCG@10: 0.0233, HR@10: 0.0416)
client: 6,  val round:4, time: 1279.327862(s), X (MRR: 0.0417, NDCG@10: 0.0429, HR@10: 0.0772), Y (MRR: 0.0148, NDCG@10: 0.0127, HR@10: 0.0269)
client: 7,  val round:4, time: 1290.340002(s), X (MRR: 0.0365, NDCG@10: 0.0366, HR@10: 0.0604), Y (MRR: 0.0245, NDCG@10: 0.0241, HR@10: 0.0470)
client: 8,  val round:4, time: 1291.219319(s), X (MRR: 0.0446, NDCG@10: 0.0439, HR@10: 0.0681), Y (MRR: 0.0232, NDCG@10: 0.0193, HR@10: 0.0339)
client: 9,  val round:4, time: 1292.193783(s), X (MRR: 0.0395, NDCG@10: 0.0395, HR@10: 0.0669), Y (MRR: 0.0220, NDCG@10: 0.0215, HR@10: 0.0422)
average round:4, time: 1292.193872(s), X (MRR: 0.0633, NDCG@10: 0.0669, HR@10: 0.1065), Y (MRR: 0.0311, NDCG@10: 0.0314, HR@10: 0.0592)
client: 0, 2022-12-05 12:28:23.043061: step 574/1400 (round 5/10), loss = 6.907643 (34.009 sec/epoch), lr: 0.001000
mi: 1.9493250399827953
client: 1, 2022-12-05 12:28:59.222434: step 588/1400 (round 5/10), loss = 6.883451 (36.179 sec/epoch), lr: 0.001000
mi: 1.9176846014601845
client: 2, 2022-12-05 12:29:30.610407: step 602/1400 (round 5/10), loss = 6.900100 (31.388 sec/epoch), lr: 0.001000
mi: 1.9197393434388295
client: 3, 2022-12-05 12:30:04.044257: step 616/1400 (round 5/10), loss = 6.950472 (33.434 sec/epoch), lr: 0.001000
mi: 1.957460847922734
client: 4, 2022-12-05 12:30:32.146302: step 630/1400 (round 5/10), loss = 6.912390 (28.102 sec/epoch), lr: 0.001000
mi: 1.9383266802345
client: 5, 2022-12-05 12:31:06.694491: step 644/1400 (round 5/10), loss = 6.815049 (34.548 sec/epoch), lr: 0.001000
mi: 1.8699450360877174
client: 6, 2022-12-05 12:31:37.310813: step 658/1400 (round 5/10), loss = 6.849800 (30.616 sec/epoch), lr: 0.001000
mi: 1.911611072506224
client: 7, 2022-12-05 12:32:05.779154: step 672/1400 (round 5/10), loss = 6.765219 (28.468 sec/epoch), lr: 0.001000
mi: 1.9007882071392879
client: 8, 2022-12-05 12:32:40.131911: step 686/1400 (round 5/10), loss = 6.810518 (34.352 sec/epoch), lr: 0.001000
mi: 1.8741318110908782
client: 9, 2022-12-05 12:33:15.120157: step 700/1400 (round 5/10), loss = 6.875523 (34.988 sec/epoch), lr: 0.001000
mi: 1.8983409941196443
Evaluating on dev set...
client: 0,  val round:5, time: 1618.846513(s), X (MRR: 0.1252, NDCG@10: 0.1371, HR@10: 0.2057), Y (MRR: 0.0696, NDCG@10: 0.0808, HR@10: 0.1508)
client: 1,  val round:5, time: 1619.914692(s), X (MRR: 0.1363, NDCG@10: 0.1480, HR@10: 0.2112), Y (MRR: 0.0757, NDCG@10: 0.0826, HR@10: 0.1351)
client: 2,  val round:5, time: 1621.156836(s), X (MRR: 0.0740, NDCG@10: 0.0792, HR@10: 0.1237), Y (MRR: 0.0297, NDCG@10: 0.0293, HR@10: 0.0546)
client: 3,  val round:5, time: 1622.241780(s), X (MRR: 0.0577, NDCG@10: 0.0646, HR@10: 0.1102), Y (MRR: 0.0291, NDCG@10: 0.0274, HR@10: 0.0504)
client: 4,  val round:5, time: 1623.203725(s), X (MRR: 0.0473, NDCG@10: 0.0523, HR@10: 0.0940), Y (MRR: 0.0210, NDCG@10: 0.0208, HR@10: 0.0453)
client: 5,  val round:5, time: 1624.461915(s), X (MRR: 0.0687, NDCG@10: 0.0698, HR@10: 0.1027), Y (MRR: 0.0272, NDCG@10: 0.0251, HR@10: 0.0451)
client: 6,  val round:5, time: 1625.394277(s), X (MRR: 0.0428, NDCG@10: 0.0474, HR@10: 0.0894), Y (MRR: 0.0184, NDCG@10: 0.0161, HR@10: 0.0303)
client: 7,  val round:5, time: 1635.599342(s), X (MRR: 0.0353, NDCG@10: 0.0358, HR@10: 0.0604), Y (MRR: 0.0215, NDCG@10: 0.0204, HR@10: 0.0417)
client: 8,  val round:5, time: 1636.490413(s), X (MRR: 0.0445, NDCG@10: 0.0444, HR@10: 0.0717), Y (MRR: 0.0251, NDCG@10: 0.0197, HR@10: 0.0321)
client: 9,  val round:5, time: 1637.490281(s), X (MRR: 0.0399, NDCG@10: 0.0378, HR@10: 0.0591), Y (MRR: 0.0222, NDCG@10: 0.0240, HR@10: 0.0507)
average round:5, time: 1637.490398(s), X (MRR: 0.0672, NDCG@10: 0.0716, HR@10: 0.1128), Y (MRR: 0.0339, NDCG@10: 0.0346, HR@10: 0.0636)
client: 0, 2022-12-05 12:34:00.125347: step 714/1400 (round 6/10), loss = 6.126256 (25.795 sec/epoch), lr: 0.001000
mi: 1.7806634749685022
client: 1, 2022-12-05 12:34:34.122814: step 728/1400 (round 6/10), loss = 6.106392 (33.997 sec/epoch), lr: 0.001000
mi: 1.732304897904396
client: 2, 2022-12-05 12:35:03.378317: step 742/1400 (round 6/10), loss = 6.131726 (29.255 sec/epoch), lr: 0.001000
mi: 1.751495446903365
client: 3, 2022-12-05 12:35:35.311535: step 756/1400 (round 6/10), loss = 6.157891 (31.933 sec/epoch), lr: 0.001000
mi: 1.7693354436329436
client: 4, 2022-12-05 12:35:58.305104: step 770/1400 (round 6/10), loss = 6.147842 (22.993 sec/epoch), lr: 0.001000
mi: 1.7625877273934232
client: 5, 2022-12-05 12:36:31.913443: step 784/1400 (round 6/10), loss = 6.053541 (33.608 sec/epoch), lr: 0.001000
mi: 1.7129831646169935
client: 6, 2022-12-05 12:37:03.223445: step 798/1400 (round 6/10), loss = 6.121248 (31.310 sec/epoch), lr: 0.001000
mi: 1.7790885380336217
client: 7, 2022-12-05 12:37:31.633122: step 812/1400 (round 6/10), loss = 5.977448 (28.409 sec/epoch), lr: 0.001000
mi: 1.7240233016865598
client: 8, 2022-12-05 12:38:05.999711: step 826/1400 (round 6/10), loss = 6.069170 (34.366 sec/epoch), lr: 0.001000
mi: 1.7453751325607303
client: 9, 2022-12-05 12:38:38.838340: step 840/1400 (round 6/10), loss = 6.127470 (32.838 sec/epoch), lr: 0.001000
mi: 1.7565488883427212
Evaluating on dev set...
client: 0,  val round:6, time: 1942.699263(s), X (MRR: 0.1358, NDCG@10: 0.1497, HR@10: 0.2215), Y (MRR: 0.0790, NDCG@10: 0.0908, HR@10: 0.1603)
client: 1,  val round:6, time: 1943.691518(s), X (MRR: 0.1497, NDCG@10: 0.1600, HR@10: 0.2174), Y (MRR: 0.0794, NDCG@10: 0.0903, HR@10: 0.1544)
client: 2,  val round:6, time: 1944.846763(s), X (MRR: 0.0706, NDCG@10: 0.0739, HR@10: 0.1134), Y (MRR: 0.0291, NDCG@10: 0.0286, HR@10: 0.0528)
client: 3,  val round:6, time: 1945.308142(s), X (MRR: 0.0585, NDCG@10: 0.0642, HR@10: 0.1061), Y (MRR: 0.0275, NDCG@10: 0.0257, HR@10: 0.0471)
client: 4,  val round:6, time: 1946.406136(s), X (MRR: 0.0496, NDCG@10: 0.0546, HR@10: 0.0940), Y (MRR: 0.0214, NDCG@10: 0.0199, HR@10: 0.0401)
client: 5,  val round:6, time: 1947.511691(s), X (MRR: 0.0742, NDCG@10: 0.0764, HR@10: 0.1103), Y (MRR: 0.0285, NDCG@10: 0.0282, HR@10: 0.0520)
client: 6,  val round:6, time: 1969.186631(s), X (MRR: 0.0430, NDCG@10: 0.0444, HR@10: 0.0772), Y (MRR: 0.0192, NDCG@10: 0.0149, HR@10: 0.0236)
client: 7,  val round:6, time: 1988.678238(s), X (MRR: 0.0351, NDCG@10: 0.0340, HR@10: 0.0528), Y (MRR: 0.0187, NDCG@10: 0.0161, HR@10: 0.0330)
client: 8,  val round:6, time: 1998.778325(s), X (MRR: 0.0437, NDCG@10: 0.0431, HR@10: 0.0717), Y (MRR: 0.0252, NDCG@10: 0.0207, HR@10: 0.0339)
client: 9,  val round:6, time: 2008.823889(s), X (MRR: 0.0381, NDCG@10: 0.0370, HR@10: 0.0591), Y (MRR: 0.0203, NDCG@10: 0.0205, HR@10: 0.0422)
average round:6, time: 2008.823999(s), X (MRR: 0.0698, NDCG@10: 0.0737, HR@10: 0.1123), Y (MRR: 0.0348, NDCG@10: 0.0356, HR@10: 0.0639)
client: 0, 2022-12-05 12:40:10.640786: step 854/1400 (round 7/10), loss = 5.478347 (24.977 sec/epoch), lr: 0.001000
mi: 1.6159404477902815
client: 1, 2022-12-05 12:40:39.406021: step 868/1400 (round 7/10), loss = 5.499636 (28.765 sec/epoch), lr: 0.001000
mi: 1.6495961040258416
client: 2, 2022-12-05 12:41:07.322878: step 882/1400 (round 7/10), loss = 5.500054 (27.916 sec/epoch), lr: 0.001000
mi: 1.6139069412435811
client: 3, 2022-12-05 12:41:36.192065: step 896/1400 (round 7/10), loss = 5.565402 (28.869 sec/epoch), lr: 0.001000
mi: 1.6724393746682578
client: 4, 2022-12-05 12:42:02.511655: step 910/1400 (round 7/10), loss = 5.532536 (26.319 sec/epoch), lr: 0.001000
mi: 1.6691466246332443
client: 5, 2022-12-05 12:42:30.671324: step 924/1400 (round 7/10), loss = 5.441423 (28.159 sec/epoch), lr: 0.001000
mi: 1.6042434530598777
client: 6, 2022-12-05 12:43:00.287910: step 938/1400 (round 7/10), loss = 5.493215 (29.616 sec/epoch), lr: 0.001000
mi: 1.6675104873520985
client: 7, 2022-12-05 12:43:25.455765: step 952/1400 (round 7/10), loss = 5.354203 (25.167 sec/epoch), lr: 0.001000
mi: 1.5977597070591794
client: 8, 2022-12-05 12:43:57.429610: step 966/1400 (round 7/10), loss = 5.453305 (31.973 sec/epoch), lr: 0.001000
mi: 1.6359961305345807
client: 9, 2022-12-05 12:44:28.884612: step 980/1400 (round 7/10), loss = 5.488347 (31.455 sec/epoch), lr: 0.001000
mi: 1.6513050147465294
Evaluating on dev set...
client: 0,  val round:7, time: 2292.783277(s), X (MRR: 0.1518, NDCG@10: 0.1638, HR@10: 0.2278), Y (MRR: 0.0874, NDCG@10: 0.0997, HR@10: 0.1679)
client: 1,  val round:7, time: 2293.992620(s), X (MRR: 0.1533, NDCG@10: 0.1648, HR@10: 0.2267), Y (MRR: 0.0832, NDCG@10: 0.0959, HR@10: 0.1641)
client: 2,  val round:7, time: 2295.003037(s), X (MRR: 0.0693, NDCG@10: 0.0726, HR@10: 0.1100), Y (MRR: 0.0276, NDCG@10: 0.0271, HR@10: 0.0510)
client: 3,  val round:7, time: 2295.511449(s), X (MRR: 0.0589, NDCG@10: 0.0668, HR@10: 0.1143), Y (MRR: 0.0287, NDCG@10: 0.0269, HR@10: 0.0471)
client: 4,  val round:7, time: 2296.417793(s), X (MRR: 0.0510, NDCG@10: 0.0563, HR@10: 0.0940), Y (MRR: 0.0199, NDCG@10: 0.0185, HR@10: 0.0383)
client: 5,  val round:7, time: 2297.507255(s), X (MRR: 0.0722, NDCG@10: 0.0770, HR@10: 0.1179), Y (MRR: 0.0315, NDCG@10: 0.0317, HR@10: 0.0555)
client: 6,  val round:7, time: 2298.507226(s), X (MRR: 0.0429, NDCG@10: 0.0416, HR@10: 0.0650), Y (MRR: 0.0188, NDCG@10: 0.0137, HR@10: 0.0202)
client: 7,  val round:7, time: 2319.267946(s), X (MRR: 0.0345, NDCG@10: 0.0327, HR@10: 0.0491), Y (MRR: 0.0171, NDCG@10: 0.0160, HR@10: 0.0365)
client: 8,  val round:7, time: 2319.872220(s), X (MRR: 0.0440, NDCG@10: 0.0466, HR@10: 0.0824), Y (MRR: 0.0265, NDCG@10: 0.0253, HR@10: 0.0446)
client: 9,  val round:7, time: 2329.738725(s), X (MRR: 0.0378, NDCG@10: 0.0381, HR@10: 0.0630), Y (MRR: 0.0214, NDCG@10: 0.0213, HR@10: 0.0405)
average round:7, time: 2329.738974(s), X (MRR: 0.0716, NDCG@10: 0.0760, HR@10: 0.1150), Y (MRR: 0.0362, NDCG@10: 0.0376, HR@10: 0.0666)
client: 0, 2022-12-05 12:45:30.307158: step 994/1400 (round 8/10), loss = 5.005146 (23.728 sec/epoch), lr: 0.001000
mi: 1.560193418179239
client: 1, 2022-12-05 12:45:55.090508: step 1008/1400 (round 8/10), loss = 5.001635 (24.783 sec/epoch), lr: 0.001000
mi: 1.548026448062488
client: 2, 2022-12-05 12:46:23.369054: step 1022/1400 (round 8/10), loss = 4.999656 (28.278 sec/epoch), lr: 0.001000
mi: 1.5317815814699451
client: 3, 2022-12-05 12:46:55.245202: step 1036/1400 (round 8/10), loss = 5.065015 (31.876 sec/epoch), lr: 0.001000
mi: 1.603838463766234
client: 4, 2022-12-05 12:47:22.192954: step 1050/1400 (round 8/10), loss = 5.007263 (26.947 sec/epoch), lr: 0.001000
mi: 1.5563635391848432
client: 5, 2022-12-05 12:47:47.842202: step 1064/1400 (round 8/10), loss = 4.983420 (25.649 sec/epoch), lr: 0.001000
mi: 1.5416996955871582
client: 6, 2022-12-05 12:48:17.762048: step 1078/1400 (round 8/10), loss = 4.975457 (29.920 sec/epoch), lr: 0.001000
mi: 1.5572848230600356
client: 7, 2022-12-05 12:48:45.841965: step 1092/1400 (round 8/10), loss = 4.885344 (28.080 sec/epoch), lr: 0.001000
mi: 1.5565480738878248
client: 8, 2022-12-05 12:49:15.833888: step 1106/1400 (round 8/10), loss = 4.944860 (29.992 sec/epoch), lr: 0.001000
mi: 1.5298811623028346
client: 9, 2022-12-05 12:49:48.667901: step 1120/1400 (round 8/10), loss = 4.991459 (32.834 sec/epoch), lr: 0.001000
mi: 1.56506878393037
Evaluating on dev set...
client: 0,  val round:8, time: 2612.331779(s), X (MRR: 0.1652, NDCG@10: 0.1769, HR@10: 0.2405), Y (MRR: 0.0925, NDCG@10: 0.1043, HR@10: 0.1679)
client: 1,  val round:8, time: 2613.354816(s), X (MRR: 0.1542, NDCG@10: 0.1693, HR@10: 0.2422), Y (MRR: 0.0878, NDCG@10: 0.0999, HR@10: 0.1660)
client: 2,  val round:8, time: 2614.245385(s), X (MRR: 0.0699, NDCG@10: 0.0739, HR@10: 0.1100), Y (MRR: 0.0277, NDCG@10: 0.0269, HR@10: 0.0492)
client: 3,  val round:8, time: 2614.733704(s), X (MRR: 0.0588, NDCG@10: 0.0636, HR@10: 0.1020), Y (MRR: 0.0249, NDCG@10: 0.0232, HR@10: 0.0437)
client: 4,  val round:8, time: 2615.344325(s), X (MRR: 0.0513, NDCG@10: 0.0545, HR@10: 0.0865), Y (MRR: 0.0165, NDCG@10: 0.0171, HR@10: 0.0418)
client: 5,  val round:8, time: 2616.222759(s), X (MRR: 0.0768, NDCG@10: 0.0775, HR@10: 0.1065), Y (MRR: 0.0323, NDCG@10: 0.0318, HR@10: 0.0520)
client: 6,  val round:8, time: 2617.326707(s), X (MRR: 0.0431, NDCG@10: 0.0436, HR@10: 0.0691), Y (MRR: 0.0184, NDCG@10: 0.0142, HR@10: 0.0219)
client: 7,  val round:8, time: 2618.525484(s), X (MRR: 0.0310, NDCG@10: 0.0281, HR@10: 0.0415), Y (MRR: 0.0149, NDCG@10: 0.0133, HR@10: 0.0330)
client: 8,  val round:8, time: 2638.789999(s), X (MRR: 0.0443, NDCG@10: 0.0483, HR@10: 0.0860), Y (MRR: 0.0257, NDCG@10: 0.0232, HR@10: 0.0374)
client: 9,  val round:8, time: 2639.304950(s), X (MRR: 0.0392, NDCG@10: 0.0374, HR@10: 0.0551), Y (MRR: 0.0222, NDCG@10: 0.0212, HR@10: 0.0372)
average round:8, time: 2639.305091(s), X (MRR: 0.0734, NDCG@10: 0.0773, HR@10: 0.1139), Y (MRR: 0.0363, NDCG@10: 0.0375, HR@10: 0.0650)
client: 0, 2022-12-05 12:50:38.132825: step 1134/1400 (round 9/10), loss = 4.581738 (21.988 sec/epoch), lr: 0.001000
mi: 1.4941897004842755
client: 1, 2022-12-05 12:51:04.132061: step 1148/1400 (round 9/10), loss = 4.574502 (25.999 sec/epoch), lr: 0.001000
mi: 1.4597396518502916
client: 2, 2022-12-05 12:51:33.259449: step 1162/1400 (round 9/10), loss = 4.596415 (29.127 sec/epoch), lr: 0.001000
mi: 1.4755207849400382
client: 3, 2022-12-05 12:52:05.050711: step 1176/1400 (round 9/10), loss = 4.602456 (31.791 sec/epoch), lr: 0.001000
mi: 1.4547308691910334
client: 4, 2022-12-05 12:52:34.000803: step 1190/1400 (round 9/10), loss = 4.574788 (28.950 sec/epoch), lr: 0.001000
mi: 1.460371344004359
client: 5, 2022-12-05 12:53:00.622428: step 1204/1400 (round 9/10), loss = 4.550983 (26.621 sec/epoch), lr: 0.001000
mi: 1.4613899780171258
client: 6, 2022-12-05 12:53:31.882579: step 1218/1400 (round 9/10), loss = 4.559063 (31.260 sec/epoch), lr: 0.001000
mi: 1.4896540262869427
client: 7, 2022-12-05 12:53:58.947851: step 1232/1400 (round 9/10), loss = 4.457273 (27.065 sec/epoch), lr: 0.001000
mi: 1.4678872576781679
client: 8, 2022-12-05 12:54:30.052845: step 1246/1400 (round 9/10), loss = 4.505274 (31.105 sec/epoch), lr: 0.001000
mi: 1.4460643325533185
client: 9, 2022-12-05 12:55:04.055300: step 1260/1400 (round 9/10), loss = 4.601215 (34.002 sec/epoch), lr: 0.001000
mi: 1.5123721156801493
Evaluating on dev set...
client: 0,  val round:9, time: 2939.041743(s), X (MRR: 0.1678, NDCG@10: 0.1809, HR@10: 0.2468), Y (MRR: 0.0979, NDCG@10: 0.1092, HR@10: 0.1698)
client: 1,  val round:9, time: 2951.520480(s), X (MRR: 0.1544, NDCG@10: 0.1703, HR@10: 0.2453), Y (MRR: 0.0917, NDCG@10: 0.1055, HR@10: 0.1737)
client: 2,  val round:9, time: 2952.536900(s), X (MRR: 0.0703, NDCG@10: 0.0747, HR@10: 0.1100), Y (MRR: 0.0276, NDCG@10: 0.0261, HR@10: 0.0455)
client: 3,  val round:9, time: 2953.068133(s), X (MRR: 0.0592, NDCG@10: 0.0621, HR@10: 0.0939), Y (MRR: 0.0231, NDCG@10: 0.0220, HR@10: 0.0437)
client: 4,  val round:9, time: 2954.137031(s), X (MRR: 0.0525, NDCG@10: 0.0546, HR@10: 0.0827), Y (MRR: 0.0170, NDCG@10: 0.0174, HR@10: 0.0401)
client: 5,  val round:9, time: 2955.069884(s), X (MRR: 0.0741, NDCG@10: 0.0762, HR@10: 0.1065), Y (MRR: 0.0327, NDCG@10: 0.0328, HR@10: 0.0537)
client: 6,  val round:9, time: 2956.458502(s), X (MRR: 0.0415, NDCG@10: 0.0407, HR@10: 0.0610), Y (MRR: 0.0177, NDCG@10: 0.0142, HR@10: 0.0236)
client: 7,  val round:9, time: 2956.975626(s), X (MRR: 0.0304, NDCG@10: 0.0278, HR@10: 0.0415), Y (MRR: 0.0148, NDCG@10: 0.0135, HR@10: 0.0330)
client: 8,  val round:9, time: 2957.612635(s), X (MRR: 0.0452, NDCG@10: 0.0504, HR@10: 0.0896), Y (MRR: 0.0254, NDCG@10: 0.0233, HR@10: 0.0374)
client: 9,  val round:9, time: 2979.385494(s), X (MRR: 0.0390, NDCG@10: 0.0374, HR@10: 0.0551), Y (MRR: 0.0210, NDCG@10: 0.0200, HR@10: 0.0355)
average round:9, time: 2979.385780(s), X (MRR: 0.0734, NDCG@10: 0.0775, HR@10: 0.1132), Y (MRR: 0.0369, NDCG@10: 0.0384, HR@10: 0.0656)
client: 0, 2022-12-05 12:56:22.142951: step 1274/1400 (round 10/10), loss = 4.223442 (25.917 sec/epoch), lr: 0.001000
mi: 1.418182893736022
client: 1, 2022-12-05 12:56:46.907152: step 1288/1400 (round 10/10), loss = 4.206914 (24.764 sec/epoch), lr: 0.001000
mi: 1.4002780565193722
client: 2, 2022-12-05 12:57:16.860343: step 1302/1400 (round 10/10), loss = 4.238326 (29.953 sec/epoch), lr: 0.001000
mi: 1.384952642236437
client: 3, 2022-12-05 12:57:48.327695: step 1316/1400 (round 10/10), loss = 4.278659 (31.467 sec/epoch), lr: 0.001000
mi: 1.457743264521871
client: 4, 2022-12-05 12:58:16.817715: step 1330/1400 (round 10/10), loss = 4.223127 (28.489 sec/epoch), lr: 0.001000
mi: 1.427600934250014
client: 5, 2022-12-05 12:58:46.861058: step 1344/1400 (round 10/10), loss = 4.185021 (30.043 sec/epoch), lr: 0.001000
mi: 1.3770149090460369
client: 6, 2022-12-05 12:59:19.332599: step 1358/1400 (round 10/10), loss = 4.205245 (32.471 sec/epoch), lr: 0.001000
mi: 1.4137129119464331
client: 7, 2022-12-05 12:59:46.178904: step 1372/1400 (round 10/10), loss = 4.112999 (26.846 sec/epoch), lr: 0.001000
mi: 1.4116419566529135
client: 8, 2022-12-05 13:00:15.255102: step 1386/1400 (round 10/10), loss = 4.148792 (29.076 sec/epoch), lr: 0.001000
mi: 1.3804987013339998
client: 9, 2022-12-05 13:00:50.457888: step 1400/1400 (round 10/10), loss = 4.224814 (35.202 sec/epoch), lr: 0.001000
mi: 1.4432923768247874
Evaluating on dev set...
client: 0,  val round:10, time: 3274.338306(s), X (MRR: 0.1706, NDCG@10: 0.1840, HR@10: 0.2500), Y (MRR: 0.0968, NDCG@10: 0.1078, HR@10: 0.1679)
client: 1,  val round:10, time: 3286.537629(s), X (MRR: 0.1567, NDCG@10: 0.1754, HR@10: 0.2578), Y (MRR: 0.0922, NDCG@10: 0.1051, HR@10: 0.1699)
client: 2,  val round:10, time: 3299.786661(s), X (MRR: 0.0715, NDCG@10: 0.0778, HR@10: 0.1168), Y (MRR: 0.0266, NDCG@10: 0.0260, HR@10: 0.0474)
client: 3,  val round:10, time: 3300.371931(s), X (MRR: 0.0590, NDCG@10: 0.0644, HR@10: 0.1020), Y (MRR: 0.0222, NDCG@10: 0.0212, HR@10: 0.0420)
client: 4,  val round:10, time: 3300.894656(s), X (MRR: 0.0517, NDCG@10: 0.0544, HR@10: 0.0827), Y (MRR: 0.0162, NDCG@10: 0.0165, HR@10: 0.0383)
client: 5,  val round:10, time: 3301.562221(s), X (MRR: 0.0750, NDCG@10: 0.0774, HR@10: 0.1065), Y (MRR: 0.0294, NDCG@10: 0.0301, HR@10: 0.0520)
client: 6,  val round:10, time: 3302.204220(s), X (MRR: 0.0395, NDCG@10: 0.0396, HR@10: 0.0610), Y (MRR: 0.0177, NDCG@10: 0.0158, HR@10: 0.0286)
client: 7,  val round:10, time: 3302.734573(s), X (MRR: 0.0316, NDCG@10: 0.0312, HR@10: 0.0491), Y (MRR: 0.0133, NDCG@10: 0.0112, HR@10: 0.0278)
client: 8,  val round:10, time: 3303.205505(s), X (MRR: 0.0462, NDCG@10: 0.0506, HR@10: 0.0860), Y (MRR: 0.0237, NDCG@10: 0.0222, HR@10: 0.0374)
client: 9,  val round:10, time: 3304.272849(s), X (MRR: 0.0393, NDCG@10: 0.0377, HR@10: 0.0551), Y (MRR: 0.0178, NDCG@10: 0.0178, HR@10: 0.0355)
average round:10, time: 3304.272954(s), X (MRR: 0.0741, NDCG@10: 0.0792, HR@10: 0.1167), Y (MRR: 0.0356, NDCG@10: 0.0374, HR@10: 0.0647)
[0.06705855 0.06327223 0.0713822  0.0416825  0.08320487 0.10831338]
[0.04029319 0.03614684 0.04187581 0.01743828 0.05325601 0.07114025]
